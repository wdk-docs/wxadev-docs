
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>wx.notifyBLECharacteristicValueChange &#8212; wxadev v2.21.0 文档</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx13.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 wxadev v2.21.0 文档 中搜索"
          href="../_static/opensearch.xml"/>

    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="wx.getBLEDeviceServices" href="wx.getBLEDeviceServices.html" />
    <link rel="prev" title="wx.onBLECharacteristicValueChange" href="wx.onBLECharacteristicValueChange.html" />
<link rel="canonical" href="http://www.sphinx-doc.org/en/master/api/wx.notifyBLECharacteristicValueChange.html" />

<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet" type="text/css" />
 
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
  
</style>
<script type="text/javascript">
  // intelligent scrolling of the sidebar content
  $(window).scroll(function() {
    var sb = $('.sphinxsidebarwrapper');
    var win = $(window);
    var sbh = sb.height();
    var offset = $('.sphinxsidebar').position()['top'];
    var wintop = win.scrollTop();
    var winbot = wintop + win.innerHeight();
    var curtop = sb.position()['top'];
    var curbot = curtop + sbh;
    // does sidebar fit in window?
    if (sbh < win.innerHeight()) {
      // yes: easy case -- always keep at the top
      sb.css('top', $u.min([$u.max([0, wintop - offset - 10]), $(document).height() - sbh - 200]));
    } else {
      // no: only scroll if top/bottom edge of sidebar is at
      // top/bottom edge of window
      if (curtop > wintop && curbot > winbot) {
        sb.css('top', $u.max([wintop - offset - 10, 0]));
      } else if (curtop < wintop && curbot < winbot) {
        sb.css('top', $u.min([winbot - sbh - offset - 20, $(document).height() - sbh - 200]));
      }
    }
  });
</script> 
  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">主页</a></li>
    <li><a href="../basic/index.html">入门</a></li>
    <li><a href="../framework/index.html">框架</a></li>
    <li><a href="../component/index.html">组件</a></li>
    <li><a href="index.html">API</a></li>
    <li><a href="../api-backend/index.html">服务端</a></li>
    <li><a href="../reference/index.html">参考</a></li>
    <li><a href="../contents.html">目录</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/wxaheader.png" alt="wxa" />
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../http-routingtable.html" title="微信小程序API"
             >wxapi</a> |</li>
        <li class="right" >
          <a href="wx.getBLEDeviceServices.html" title="wx.getBLEDeviceServices"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="wx.onBLECharacteristicValueChange.html" title="wx.onBLECharacteristicValueChange"
             accesskey="P">上一页</a> |</li>
<li><a href="../index.html">主页</a>&#160;|</li>
<li><a href="../contents.html">文档</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">API</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">wx.notifyBLECharacteristicValueChange</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>上一个主题</h4>
  <p class="topless"><a href="wx.onBLECharacteristicValueChange.html"
                        title="上一章">wx.onBLECharacteristicValueChange</a></p>
  <h4>下一个主题</h4>
  <p class="topless"><a href="wx.getBLEDeviceServices.html"
                        title="下一章">wx.getBLEDeviceServices</a></p>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/wx.notifyBLECharacteristicValueChange.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="wx-notifyblecharacteristicvaluechange">
<h1><a class="reference external" href="https://developers.weixin.qq.com/miniprogram/dev/api/wx.notifyBLECharacteristicValueChange.html">wx.notifyBLECharacteristicValueChange</a><a class="headerlink" href="#wx-notifyblecharacteristicvaluechange" title="永久链接至标题">¶</a></h1>
<dl class="js function">
<dt class="sig sig-object js" id="wx.notifyBLECharacteristicValueChange">
<span class="sig-prename descclassname"><span class="n"><span class="pre">wx</span></span><span class="p"><span class="pre">.</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">notifyBLECharacteristicValueChange</span></span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Object</span> <span class="pre">object</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#wx.notifyBLECharacteristicValueChange" title="永久链接至目标">¶</a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">1.1.0 新版功能: </span>低版本需做 <a class="reference internal" href="../framework/compatibility.html#compatibility"><span class="std std-ref">兼容处理</span></a> 。</p>
</div>
</dd></dl>

<p>启用低功耗蓝牙设备特征值变化时的 notify 功能，订阅特征值。注意：必须设备的特征值支持 notify 或者 indicate 才可以成功调用。</p>
<p>另外，必须先启用 notifyBLECharacteristicValueChange 才能监听到设备 characteristicValueChange 事件</p>
<p>参数
Object object
属性      类型      默认值     必填      说明
deviceId        string          是       蓝牙设备 id
serviceId       string          是       蓝牙特征值对应服务的 uuid
characteristicId        string          是       蓝牙特征值的 uuid
state   boolean         是       是否启用 notify
success function                否       接口调用成功的回调函数
fail    function                否       接口调用失败的回调函数
complete        function                否       接口调用结束的回调函数（调用成功、失败都会执行）
错误
错误码     错误信息    说明
0       ok      正常
10000   not init        未初始化蓝牙适配器
10001   not available   当前蓝牙适配器不可用
10002   no device       没有找到指定设备
10003   connection fail 连接失败
10004   no service      没有找到指定服务
10005   no characteristic       没有找到指定特征值
10006   no connection   当前连接已断开
10007   property not support    当前特征值不支持此操作
10008   system error    其余所有系统上报的异常
10009   system not support      Android 系统特有，系统版本低于 4.3 不支持 BLE
10012   operate time out        连接超时
10013   invalid_data    连接 deviceId 为空或者是格式不正确
注意
订阅操作成功后需要设备主动更新特征值的 value，才会触发 wx.onBLECharacteristicValueChange 回调。
安卓平台上，在调用 notifyBLECharacteristicValueChange 成功后立即调用 writeBLECharacteristicValue 接口，在部分机型上会发生 10008 系统错误
示例代码
在开发者工具中预览效果</p>
<dl>
<dt>wx.notifyBLECharacteristicValueChange({</dt><dd><p>state: true, // 启用 notify 功能
// 这里的 deviceId 需要已经通过 createBLEConnection 与对应设备建立链接
deviceId,
// 这里的 serviceId 需要在 getBLEDeviceServices 接口中获取
serviceId,
// 这里的 characteristicId 需要在 getBLEDeviceCharacteristics 接口中获取
characteristicId,
success(res) {</p>
<blockquote>
<div><p>console.log(‘notifyBLECharacteristicValueChange success’, res.errMsg)</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>})</p>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="../http-routingtable.html" title="微信小程序API"
             >wxapi</a> |</li>
        <li class="right" >
          <a href="wx.getBLEDeviceServices.html" title="wx.getBLEDeviceServices"
             >下一页</a> |</li>
        <li class="right" >
          <a href="wx.onBLECharacteristicValueChange.html" title="wx.onBLECharacteristicValueChange"
             >上一页</a> |</li>
<li><a href="../index.html">主页</a>&#160;|</li>
<li><a href="../contents.html">文档</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >API</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">wx.notifyBLECharacteristicValueChange</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2019, Wxadev Docs.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>