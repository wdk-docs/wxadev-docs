:wxfrwk:`模板消息(已作废) <open-ability/template-message>`
======================================================

微信6.5.2及以上版本支持

基于微信的通知渠道，我们为开发者提供了可以高效触达用户的模板消息能力，以便实现服务的闭环并提供更佳的体验。

- 模板推送位置：服务通知
- 模板下发条件：用户本人在微信体系内与页面有交互行为后触发，详见 下发条件说明
- 模板跳转能力：点击查看详情仅能跳转下发模板的该帐号的各个页面

使用说明
-------------

步骤一：获取模板 ID
~~~~~~~~~~~~~~~~~~~~~~·

有两个方法可以获取模板 ID：

1. 通过模板消息管理接口获取模板 ID（详见 模板消息管理）
2. 在微信公众平台手动配置获取模板 ID

登录 https://mp.weixin.qq.com 获取模板，如果没有合适的模板，可以申请添加新模板，审核通过后可使用，详见 模板审核说明

.. image:: https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/image/mp-notice.jpg?t=19041921

步骤二：页面的 <form/> 组件，属性 report-submit 为 true 时，可以声明为需要发送模板消息，此时点击按钮提交表单可以获取 formId，用于发送模板消息。或者当用户完成 支付行为，可以获取 prepay_id 用于发送模板消息。

步骤三：调用接口下发模板消息（详见 templateMessage.send ）

使用效果
-------------

.. image:: https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/image/notice.png?t=19041921

模板消息管理
---------------

#. 获取小程序模板库标题列表
#. 获取模板库某个模板标题下关键词库
#. 组合模板并添加至帐号下的个人模板库
#. 获取帐号下已存在的模板列表
#. 删除帐号下的某个模板

下发条件说明
-----------------

1. 支付

  当用户在小程序内完成过支付行为，可允许开发者向用户在7天内推送有限条数的模板消息（1次支付可下发3条，多次支付下发条数独立，互相不影响）

2. 提交表单

  当用户在小程序内发生过提交表单行为且该表单声明为要发模板消息的，开发者需要向用户提供服务时，可允许开发者向用户在7天内推送有限条数的模板消息（1次提交表单可下发1条，多次提交下发条数独立，相互不影响）

审核说明
--------------

1. 标题

  - 标题不能存在相同
  - 标题意思不能存在过度相似
  - 标题必须以“提醒”或“通知”结尾
  - 标题不能带特殊符号、个性化字词等没有行业通用性的内容
  - 标题必须能体现具体服务场景
  - 标题不能涉及营销相关内容，包括不限于：消费优惠类、购物返利类、商品更新类、优惠券类、代金券类、红包类、会员卡类、积分类、活动类等营销倾向通知

2. 关键词

  - 同一标题下，关键词不能存在相同
  - 同一标题下，关键词不能存在过度相似
  - 关键词不能带特殊符号、个性化字词等没有行业通用性的内容
  - 关键词内容示例必须与关键词对应匹配
  - 关键词不能太过宽泛，需要具有限制性，例如：“内容”这个就太宽泛，不能审核通过

违规说明
----------

除不能违反运营规范外，还不能违反以下规则，包括但不限于：

#. 不允许恶意诱导用户进行触发操作，以达到可向用户下发模板目的
#. 不允许恶意骚扰，下发对用户造成骚扰的模板
#. 不允许恶意营销，下发营销目的模板

处罚说明
------------

根据违规情况给予相应梯度的处罚，一般处罚规则如下：

- 第一次违规，删除违规模板以示警告，
- 第二次违规，封禁接口7天，
- 第三次违规，封禁接口30天，
- 第四次违规，永久封禁接口

处罚结果及原因以站内信形式告知
