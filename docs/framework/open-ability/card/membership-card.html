
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <title>会员卡组件 &#8212; wxadev 1.0.0 文档</title>
    <link rel="stylesheet" href="../../../_static/sphinx13.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../_static/translations.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 wxadev 1.0.0 文档 中搜索"
          href="../../../_static/opensearch.xml"/>

    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../search.html" />
    <link rel="next" title="调试" href="../../usability.html" />
    <link rel="prev" title="卡券" href="card.html" />
<link rel="canonical" href="http://www.sphinx-doc.org/en/master/framework/open-ability/card/membership-card.html" />

<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet" type="text/css" />
 
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
  
</style>
<script type="text/javascript">
  // intelligent scrolling of the sidebar content
  $(window).scroll(function() {
    var sb = $('.sphinxsidebarwrapper');
    var win = $(window);
    var sbh = sb.height();
    var offset = $('.sphinxsidebar').position()['top'];
    var wintop = win.scrollTop();
    var winbot = wintop + win.innerHeight();
    var curtop = sb.position()['top'];
    var curbot = curtop + sbh;
    // does sidebar fit in window?
    if (sbh < win.innerHeight()) {
      // yes: easy case -- always keep at the top
      sb.css('top', $u.min([$u.max([0, wintop - offset - 10]), $(document).height() - sbh - 200]));
    } else {
      // no: only scroll if top/bottom edge of sidebar is at
      // top/bottom edge of window
      if (curtop > wintop && curbot > winbot) {
        sb.css('top', $u.max([wintop - offset - 10, 0]));
      } else if (curtop < wintop && curbot < winbot) {
        sb.css('top', $u.min([winbot - sbh - offset - 20, $(document).height() - sbh - 200]));
      }
    }
  });
</script> 
  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../../../index.html">主页</a></li>
    <li><a href="../../../basic/index.html">入门</a></li>
    <li><a href="../../index.html">框架</a></li>
    <li><a href="../../../component/index.html">组件</a></li>
    <li><a href="../../../api/index.html">API</a></li>
    <li><a href="../../../api-backend/index.html">服务端</a></li>
    <li><a href="../../../reference/index.html">参考</a></li>
    <li><a href="../../../contents.html">目录</a></li>
  </ul>
  <div>
    <a href="../../../index.html">
      <img src="../../../_static/wxaheader.png" alt="wxa" />
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../../../http-routingtable.html" title="微信小程序API"
             >wxapi</a> |</li>
        <li class="right" >
          <a href="../../usability.html" title="调试"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="card.html" title="卡券"
             accesskey="P">上一页</a> |</li>
<li><a href="../../../index.html">主页</a>&#160;|</li>
<li><a href="../../../contents.html">文档</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >框架</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >开放能力</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U">卡券</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../contents.html">目录</a></h3>
  <ul>
<li><a class="reference internal" href="#">会员卡组件</a><ul>
<li><a class="reference internal" href="#id3">参数说明</a></li>
<li><a class="reference internal" href="#id4">返回参数</a></li>
<li><a class="reference internal" href="#id5">示例代码</a></li>
<li><a class="reference internal" href="#id6">返回说明</a></li>
</ul>
</li>
</ul>

  <h4>上一个主题</h4>
  <p class="topless"><a href="card.html"
                        title="上一章">卡券</a></p>
  <h4>下一个主题</h4>
  <p class="topless"><a href="../../usability.html"
                        title="下一章">调试</a></p>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/framework/open-ability/card/membership-card.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1><a class="reference external" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/card/membership-card.html">会员卡组件</a><a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<p>开发者可以在小程序内调用该接口拉起会员开卡组件，方便用户快速填写会员注册信息并领卡。该接口拉起开卡组件无须提前将开卡组件和发起小程序绑定至同一个公众号，开发者直接调用即可。</p>
<p>调用前开发者须完成以下步骤：</p>
<ol class="arabic simple">
<li><p>创建一张微信会员卡并设置为一键激活模式；</p></li>
<li><p>设置开卡字段；</p></li>
<li><p>获取开卡组件参数；</p></li>
</ol>
<p>详情查看会员开卡组件介绍：<a class="reference external" href="https://mp.weixin.qq.com/cgi-bin/announce?action=getannouncement&amp;key=1479824356&amp;version=1&amp;lang=zh_CN&amp;platform=2">会员开卡组件</a></p>
<div class="section" id="id3">
<h2>参数说明<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>参数名</p></th>
<th class="head"><p>类型</p></th>
<th class="head"><p>是否必填</p></th>
<th class="head"><p>参数说明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>appId</p></td>
<td><p>String</p></td>
<td><p>是</p></td>
<td><p>填写 wxeb490c6f9b154ef9，固定为此appid</p></td>
</tr>
<tr class="row-odd"><td><p>extraData</p></td>
<td><p>Object</p></td>
<td><p>是</p></td>
<td><p>开卡组件参数，由第3步获取，包含以下三个参数</p></td>
</tr>
<tr class="row-even"><td><p>encrypt_card_id</p></td>
<td><p>String</p></td>
<td><p>是</p></td>
<td><p>加密 card_id，传入前须 urldecode</p></td>
</tr>
<tr class="row-odd"><td><p>outer_str</p></td>
<td><p>String</p></td>
<td><p>是</p></td>
<td><p>会员卡领取渠道值，会在卡券领取事件回传给商户</p></td>
</tr>
<tr class="row-even"><td><p>biz</p></td>
<td><p>String</p></td>
<td><p>是</p></td>
<td><p>商户公众号标识参数，传入前须 urldecode</p></td>
</tr>
<tr class="row-odd"><td><p>success</p></td>
<td><p>Function</p></td>
<td><p>否</p></td>
<td><p>接口调用成功的回调函数</p></td>
</tr>
<tr class="row-even"><td><p>fail</p></td>
<td><p>Function</p></td>
<td><p>否</p></td>
<td><p>接口调用失败的回调函数</p></td>
</tr>
<tr class="row-odd"><td><p>complete</p></td>
<td><p>Function</p></td>
<td><p>否</p></td>
<td><p>接口调用结束的回调函数（调用成功、失败都会执行）</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id4">
<h2>返回参数<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 31%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>参数名</p></th>
<th class="head"><p>类型</p></th>
<th class="head"><p>参数说明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>errMsg</p></td>
<td><p>String</p></td>
<td><p>调用结果</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id5">
<h2>示例代码<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h2>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">wx</span><span class="p">.</span><span class="nx">navigateToMiniProgram</span><span class="p">({</span>
  <span class="nx">appId</span><span class="o">:</span> <span class="s1">&#39;wxeb490c6f9b154ef9&#39;</span><span class="p">,</span> <span class="c1">// 固定为此 appid，不可改动</span>
  <span class="nx">extraData</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span> <span class="c1">// 包括 encrypt_card_id, outer_str, biz三个字段，须从 step3 中获得的链接中获取参数</span>
  <span class="nx">success</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">},</span>
  <span class="nx">fail</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">},</span>
  <span class="nx">complete</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>navigateToMiniProgram 接口即将废弃，新版本中请使用 <a class="reference internal" href="../../../component/navigator.html#navigator"><span class="std std-ref">&lt;navigator&gt;</span></a> 组件来使用此功能</p>
</div>
<div class="section" id="id6">
<h2>返回说明<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h2>
<p>在 App.onShow 里判断从会员开卡小程序返回的数据data</p>
<ol class="arabic simple">
<li><p>判断 data.referrerInfo.appId 是否为开卡小程序 appId wxeb490c6f9b154ef9，如果不是则中止判断</p></li>
<li><p>判断是否有 data.referrerInfo.extraData 是否有数据，如果没有，表示用户未激活直接左滑/点返回键返回，或者用户已经激活</p></li>
<li><p>若用户激活成功，可以从 data.referrerInfo.extraData
中获取 activate_ticket，card_id，code 参数用于下一步操作</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<ul class="simple">
<li><p>在开发者工具上调用此 API 并不会真实的跳转到另外的小程序，但是开发者工具会校验本次调用跳转是否成功详情</p></li>
<li><p>开发者工具上支持被跳转的小程序处理接收参数的调试详情</p></li>
<li><p>开卡组件是使用wx.navigateToMiniProgram开发的官方组件，跳转时无须绑定同一个公众号，直接调用即可</p></li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="../../../http-routingtable.html" title="微信小程序API"
             >wxapi</a> |</li>
        <li class="right" >
          <a href="../../usability.html" title="调试"
             >下一页</a> |</li>
        <li class="right" >
          <a href="card.html" title="卡券"
             >上一页</a> |</li>
<li><a href="../../../index.html">主页</a>&#160;|</li>
<li><a href="../../../contents.html">文档</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >框架</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >开放能力</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" >卡券</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2019, Wxadev Docs.
      由 <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.0+/529a72d 创建。
    </div>
  </body>
</html>