

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>web-view &mdash; wxadev 1.0.0 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="native-component" href="native-component.html" />
    <link rel="prev" title="open-data" href="open-data.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../contents.html" class="icon icon-home"> wxadev
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">开发指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev.html">简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/index.html">基础教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">运行环境</a></li>
<li class="toctree-l1"><a class="reference internal" href="../framework/index.html">框架</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">组件</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#id2">视图容器</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id3">基础内容</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id4">表单组件</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id5">导航</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id6">媒体组件</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id7">地图</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id8">画布</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#id9">开放能力</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ad.html">ad</a></li>
<li class="toctree-l3"><a class="reference internal" href="official-account.html">official-account</a></li>
<li class="toctree-l3"><a class="reference internal" href="open-data.html">open-data</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">web-view</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id10">原生组件说明</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#ncur">原生组件的使用限制</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id12">无妨碍访问</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-backend/index.html">服务端API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devtools/index.html">开发工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">参考资料</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wxcloud/index.html">云开发</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">术语</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../contents.html">wxadev</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">组件</a> &raquo;</li>
        
      <li>web-view</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/component/web-view.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="web-view">
<h1>web-view<a class="headerlink" href="#web-view" title="永久链接至标题">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified added">1.6.4 新版功能: </span>开始支持，低版本需做兼容处理。</p>
</div>
<p>承载网页的容器。会自动铺满整个小程序页面，个人类型与海外类型的小程序暂不支持使用。</p>
<p>客户端 6.7.2 版本开始，navigationStyle: custom 对 &lt;web-view&gt; 组件无效</p>
<p>属性      类型      默认值     必填      说明      最低版本
src     string          否       webview 指向网页的链接。可打开关联的公众号的文章，其它网页需登录小程序管理后台配置业务域名。      1.6.4
bindmessage     eventhandler            否       网页向小程序 postMessage 时，会在特定时机（小程序后退、组件销毁、分享）触发并收到消息。e.detail = { data }，data是多次 postMessage 的参数组成的数组      1.6.4
bindload        eventhandler            否       网页加载成功时候触发此事件。e.detail = { src }        1.6.4
binderror       eventhandler            否       网页加载失败的时候触发此事件。e.detail = { src }       1.6.4
相关接口 1
&lt;web-view&gt;网页中可使用JSSDK 1.3.2提供的接口返回小程序页面。 支持的接口有：</p>
<p>接口名     说明      最低版本
wx.miniProgram.navigateTo       参数与小程序接口一致      1.6.4
wx.miniProgram.navigateBack     参数与小程序接口一致      1.6.4
wx.miniProgram.switchTab        参数与小程序接口一致      1.6.5
wx.miniProgram.reLaunch 参数与小程序接口一致      1.6.5
wx.miniProgram.redirectTo       参数与小程序接口一致      1.6.5
wx.miniProgram.postMessage      向小程序发送消息，会在特定时机（小程序后退、组件销毁、分享）触发组件的message事件    1.7.1
wx.miniProgram.getEnv   获取当前环境  1.7.1
示例代码
在开发者工具中预览效果</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="c">&lt;!-- html --&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span>
  <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span>
  <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://res.wx.qq.com/open/js/jweixin-1.3.2.js&quot;</span>
<span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

// javascript wx.miniProgram.navigateTo({url: &#39;/path/to/page&#39;})
wx.miniProgram.postMessage({ data: &#39;foo&#39; }) wx.miniProgram.postMessage({ data:
{foo: &#39;bar&#39;} }) wx.miniProgram.getEnv(function(res) {
console.log(res.miniprogram) // true })
</pre></div>
</div>
<p>相关接口 2
&lt;web-view&gt;网页中仅支持以下JSSDK接口：</p>
<p>接口模块    接口说明    具体接口
判断客户端是否支持js             checkJSApi
图像接口    拍照或上传   chooseImage
预览图片    previewImage
上传图片    uploadImage
下载图片    downloadImage
获取本地图片  getLocalImgData
音频接口    开始录音    startRecord
停止录音    stopRecord
监听录音自动停止        onVoiceRecordEnd
播放语音    playVoice
暂停播放    pauseVoice
停止播放    stopVoice
监听语音播放完毕        onVoicePlayEnd
上传接口    uploadVoice
下载接口    downloadVoice
智能接口    识别音频    translateVoice
设备信息    获取网络状态  getNetworkType
地理位置    使用内置地图打开地点      openLocation
获取地理位置  getLocation
摇一摇周边   开启ibeacon       startSearchBeacons
关闭ibeacon       stopSearchBeacons
监听ibeacon       onSearchBeacons
微信扫一扫   调起微信扫一扫 scanQRCode
微信卡券    拉取使用卡券列表        chooseCard
批量添加卡券接口        addCard
查看微信卡包的卡券       openCard
长按识别    小程序圆形码  无
相关接口 3
用户分享时可获取当前&lt;web-view&gt;的URL，即在onShareAppMessage回调中返回webViewUrl参数。</p>
<p>示例代码
示例代码：</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span>Page({
  onShareAppMessage(options) {
    console.log(options.webViewUrl)
  }
})
相关接口 4
在网页内可通过window.__wxjs_environment变量判断是否在小程序环境，建议在WeixinJSBridgeReady回调中使用，也可以使用JSSDK 1.3.2提供的getEnv接口。

示例代码
// web-view下的页面内
function ready() {
  console.log(window.__wxjs_environment === &#39;miniprogram&#39;) // true
}
if (!window.WeixinJSBridge || !WeixinJSBridge.invoke) {
  document.addEventListener(&#39;WeixinJSBridgeReady&#39;, ready, false)
} else {
  ready()
}

// 或者
wx.miniProgram.getEnv(function (res) {
  console.log(res.miniprogram) // true
})
</pre></div>
</div>
<p>相关接口 5
从微信7.0.0开始，可以通过判断userAgent中包含miniProgram字样来判断小程序web-view环境。</p>
<p>Bug &amp; Tip</p>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>网页内 iframe 的域名也需要配置到域名白名单。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>开发者工具上，可以在 &lt;web-view&gt; 组件上通过右键 - 调试，打开 &lt;web-view&gt; 组件的调试。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>每个页面只能有一个 &lt;web-view&gt;，&lt;web-view&gt; 会自动铺满整个页面，并覆盖其他组件。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>&lt;web-view&gt; 网页与小程序之间不支持除 JSSDK 提供的接口之外的通信。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>在 iOS 中，若存在JSSDK接口调用无响应的情况，可在 &lt;web-view&gt; 的 src 后面加个#wechat_redirect解决。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>避免在链接中带有中文字符，在 iOS 中会有打开白屏的问题，建议加一下 encodeURIComponent</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="native-component.html" class="btn btn-neutral float-right" title="native-component" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="open-data.html" class="btn btn-neutral float-left" title="open-data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Nosy

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>