
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>web-view &#8212; wxadev v2.21.0 文档</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx13.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 wxadev v2.21.0 文档 中搜索"
          href="../_static/opensearch.xml"/>

    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="原生组件" href="native-component.html" />
    <link rel="prev" title="open-data" href="open-data.html" />
<link rel="canonical" href="http://www.sphinx-doc.org/en/master/component/web-view.html" />

<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet" type="text/css" />
 
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
  
</style>
<script type="text/javascript">
  // intelligent scrolling of the sidebar content
  $(window).scroll(function() {
    var sb = $('.sphinxsidebarwrapper');
    var win = $(window);
    var sbh = sb.height();
    var offset = $('.sphinxsidebar').position()['top'];
    var wintop = win.scrollTop();
    var winbot = wintop + win.innerHeight();
    var curtop = sb.position()['top'];
    var curbot = curtop + sbh;
    // does sidebar fit in window?
    if (sbh < win.innerHeight()) {
      // yes: easy case -- always keep at the top
      sb.css('top', $u.min([$u.max([0, wintop - offset - 10]), $(document).height() - sbh - 200]));
    } else {
      // no: only scroll if top/bottom edge of sidebar is at
      // top/bottom edge of window
      if (curtop > wintop && curbot > winbot) {
        sb.css('top', $u.max([wintop - offset - 10, 0]));
      } else if (curtop < wintop && curbot < winbot) {
        sb.css('top', $u.min([winbot - sbh - offset - 20, $(document).height() - sbh - 200]));
      }
    }
  });
</script> 
  </head><body>
<div class="pageheader">
  <ul>
    <li><a href="../index.html">主页</a></li>
    <li><a href="../basic/index.html">入门</a></li>
    <li><a href="../framework/index.html">框架</a></li>
    <li><a href="index.html">组件</a></li>
    <li><a href="../api/index.html">API</a></li>
    <li><a href="../api-backend/index.html">服务端</a></li>
    <li><a href="../reference/index.html">参考</a></li>
    <li><a href="../contents.html">目录</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/wxaheader.png" alt="wxa" />
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../http-routingtable.html" title="微信小程序API"
             >wxapi</a> |</li>
        <li class="right" >
          <a href="native-component.html" title="原生组件"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="open-data.html" title="open-data"
             accesskey="P">上一页</a> |</li>
<li><a href="../index.html">主页</a>&#160;|</li>
<li><a href="../contents.html">文档</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">组件</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">web-view</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>上一个主题</h4>
  <p class="topless"><a href="open-data.html"
                        title="上一章">open-data</a></p>
  <h4>下一个主题</h4>
  <p class="topless"><a href="native-component.html"
                        title="下一章">原生组件</a></p>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/component/web-view.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="web-view">
<span id="id1"></span><h1><a class="reference external" href="https://developers.weixin.qq.com/miniprogram/dev/component/web-view.html">web-view</a><a class="headerlink" href="#web-view" title="永久链接至标题">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified added">1.6.4 新版功能: </span>低版本需做 <a class="reference internal" href="../framework/compatibility.html#compatibility"><span class="std std-ref">兼容处理</span></a> 。</p>
</div>
<p>承载网页的容器。会自动铺满整个小程序页面，个人类型与海外类型的小程序暂不支持使用。</p>
<p>客户端 6.7.2 版本开始，navigationStyle: custom 对 &lt;web-view&gt; 组件无效</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 4%" />
<col style="width: 3%" />
<col style="width: 75%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>属性</p></th>
<th class="head"><p>类型</p></th>
<th class="head"><p>默认值</p></th>
<th class="head"><p>必填</p></th>
<th class="head"><p>说明</p></th>
<th class="head"><p>最低版本</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>src</p></td>
<td><p>string</p></td>
<td></td>
<td><p>否</p></td>
<td><p>webview 指向网页的链接。可打开关联的公众号的文章，其它网页需登录小程序管理后台配置业务域名。</p></td>
<td><p>1.6.4</p></td>
</tr>
<tr class="row-odd"><td><p>bindmessage</p></td>
<td><p>eventhandler</p></td>
<td></td>
<td><p>否</p></td>
<td><p>网页向小程序 postMessage 时，会在特定时机（小程序后退、组件销毁、分享）触发并收到消息。e.detail = { data }，data是多次 postMessage 的参数组成的数组</p></td>
<td><p>1.6.4</p></td>
</tr>
<tr class="row-even"><td><p>bindload</p></td>
<td><p>eventhandler</p></td>
<td></td>
<td><p>否</p></td>
<td><p>网页加载成功时候触发此事件。e.detail = { src }</p></td>
<td><p>1.6.4</p></td>
</tr>
<tr class="row-odd"><td><p>binderror</p></td>
<td><p>eventhandler</p></td>
<td></td>
<td><p>否</p></td>
<td><p>网页加载失败的时候触发此事件。e.detail = { src }</p></td>
<td><p>1.6.4</p></td>
</tr>
</tbody>
</table>
<p>相关接口 1</p>
<p>&lt;web-view&gt;网页中可使用JSSDK 1.3.2提供的接口返回小程序页面。 支持的接口有：</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 68%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>接口名</p></th>
<th class="head"><p>说明</p></th>
<th class="head"><p>最低版本</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>wx.miniProgram.navigateTo</p></td>
<td><p>参数与小程序接口一致</p></td>
<td><p>1.6.4</p></td>
</tr>
<tr class="row-odd"><td><p>wx.miniProgram.navigateBack</p></td>
<td><p>参数与小程序接口一致</p></td>
<td><p>1.6.4</p></td>
</tr>
<tr class="row-even"><td><p>wx.miniProgram.switchTab</p></td>
<td><p>参数与小程序接口一致</p></td>
<td><p>1.6.5</p></td>
</tr>
<tr class="row-odd"><td><p>wx.miniProgram.reLaunch</p></td>
<td><p>参数与小程序接口一致</p></td>
<td><p>1.6.5</p></td>
</tr>
<tr class="row-even"><td><p>wx.miniProgram.redirectTo</p></td>
<td><p>参数与小程序接口一致</p></td>
<td><p>1.6.5</p></td>
</tr>
<tr class="row-odd"><td><p>wx.miniProgram.postMessage</p></td>
<td><p>向小程序发送消息，会在特定时机（小程序后退、组件销毁、分享）触发组件的message事件</p></td>
<td><p>1.7.1</p></td>
</tr>
<tr class="row-even"><td><p>wx.miniProgram.getEnv</p></td>
<td><p>获取当前环境</p></td>
<td><p>1.7.1</p></td>
</tr>
</tbody>
</table>
<p>示例代码</p>
<p>在开发者工具中预览效果</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="c">&lt;!-- html --&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span>
  <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span>
  <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://res.wx.qq.com/open/js/jweixin-1.3.2.js&quot;</span>
<span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// javascript</span>
<span class="nx">wx</span><span class="p">.</span><span class="nx">miniProgram</span><span class="p">.</span><span class="nx">navigateTo</span><span class="p">({</span><span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;/path/to/page&#39;</span><span class="p">})</span>
<span class="nx">wx</span><span class="p">.</span><span class="nx">miniProgram</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span> <span class="nx">data</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span> <span class="p">})</span>
<span class="nx">wx</span><span class="p">.</span><span class="nx">miniProgram</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">({</span> <span class="nx">data</span><span class="o">:</span>
  <span class="p">{</span><span class="nx">foo</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">}</span>
<span class="p">})</span>
<span class="nx">wx</span><span class="p">.</span><span class="nx">miniProgram</span><span class="p">.</span><span class="nx">getEnv</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">miniprogram</span><span class="p">)</span> <span class="c1">// true</span>
<span class="p">})</span>
</pre></div>
</div>
<p>相关接口 2</p>
<p>&lt;web-view&gt;网页中仅支持以下JSSDK接口：</p>
<p>接口模块    接口说明    具体接口
判断客户端是否支持js             checkJSApi
图像接口    拍照或上传   chooseImage
预览图片    previewImage
上传图片    uploadImage
下载图片    downloadImage
获取本地图片  getLocalImgData
音频接口    开始录音    startRecord
停止录音    stopRecord
监听录音自动停止        onVoiceRecordEnd
播放语音    playVoice
暂停播放    pauseVoice
停止播放    stopVoice
监听语音播放完毕        onVoicePlayEnd
上传接口    uploadVoice
下载接口    downloadVoice
智能接口    识别音频    translateVoice
设备信息    获取网络状态  getNetworkType
地理位置    使用内置地图打开地点      openLocation
获取地理位置  getLocation
摇一摇周边   开启ibeacon       startSearchBeacons
关闭ibeacon       stopSearchBeacons
监听ibeacon       onSearchBeacons
微信扫一扫   调起微信扫一扫 scanQRCode
微信卡券    拉取使用卡券列表        chooseCard
批量添加卡券接口        addCard
查看微信卡包的卡券       openCard
长按识别    小程序圆形码  无</p>
<p>相关接口 3</p>
<p>用户分享时可获取当前&lt;web-view&gt;的URL，即在onShareAppMessage回调中返回webViewUrl参数。</p>
<p>示例代码</p>
<p>示例代码：</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span>Page({
  onShareAppMessage(options) {
    console.log(options.webViewUrl)
  }
})
相关接口 4
在网页内可通过window.__wxjs_environment变量判断是否在小程序环境，建议在WeixinJSBridgeReady回调中使用，也可以使用JSSDK 1.3.2提供的getEnv接口。

示例代码
// web-view下的页面内
function ready() {
  console.log(window.__wxjs_environment === &#39;miniprogram&#39;) // true
}
if (!window.WeixinJSBridge || !WeixinJSBridge.invoke) {
  document.addEventListener(&#39;WeixinJSBridgeReady&#39;, ready, false)
} else {
  ready()
}

// 或者
wx.miniProgram.getEnv(function (res) {
  console.log(res.miniprogram) // true
})
</pre></div>
</div>
<p>相关接口 5
从微信7.0.0开始，可以通过判断userAgent中包含miniProgram字样来判断小程序web-view环境。</p>
<p>Bug &amp; Tip</p>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>网页内 iframe 的域名也需要配置到域名白名单。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>开发者工具上，可以在 &lt;web-view&gt; 组件上通过右键 - 调试，打开 &lt;web-view&gt; 组件的调试。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>每个页面只能有一个 &lt;web-view&gt;，&lt;web-view&gt; 会自动铺满整个页面，并覆盖其他组件。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>&lt;web-view&gt; 网页与小程序之间不支持除 JSSDK 提供的接口之外的通信。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>在 iOS 中，若存在JSSDK接口调用无响应的情况，可在 &lt;web-view&gt; 的 src 后面加个#wechat_redirect解决。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>避免在链接中带有中文字符，在 iOS 中会有打开白屏的问题，建议加一下 encodeURIComponent</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总目录"
             >索引</a></li>
        <li class="right" >
          <a href="../http-routingtable.html" title="微信小程序API"
             >wxapi</a> |</li>
        <li class="right" >
          <a href="native-component.html" title="原生组件"
             >下一页</a> |</li>
        <li class="right" >
          <a href="open-data.html" title="open-data"
             >上一页</a> |</li>
<li><a href="../index.html">主页</a>&#160;|</li>
<li><a href="../contents.html">文档</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >组件</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">web-view</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; 版权所有 2019, Wxadev Docs.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>